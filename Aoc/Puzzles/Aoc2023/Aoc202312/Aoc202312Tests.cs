using FluentAssertions;
using NUnit.Framework;

namespace Pzl.Aoc.Puzzles.Aoc2023.Aoc202312;

public class Aoc202312Tests
{
    [Test]
    public void Part1()
    {
        const string input = """
                             ???.### 1,1,3
                             .??..??...?##. 1,1,3
                             ?#?#?#?#?#?#?#? 1,3,1,6
                             ????.#...#... 4,1,1
                             ????.######..#####. 1,6,5
                             ?###???????? 3,2,1
                             """;

        var result = new Aoc202312(input).RunFunctions.First()();

        result.Answer.Should().Be("21");
    }

    //[Test]
    //public void Part2()
    //{
    //    const string input = """
    //                         ???.### 1,1,3
    //                         .??..??...?##. 1,1,3
    //                         ?#?#?#?#?#?#?#? 1,3,1,6
    //                         ????.#...#... 4,1,1
    //                         ????.######..#####. 1,6,5
    //                         ?###???????? 3,2,1
    //                         """;

    //    var result = new Aoc202312(input).RunFunctions.Last()();

    //    result.Answer.Should().Be("525152");
    //}

    [TestCase("???.### 1,1,3", 1)]
    [TestCase(".??..??...?##. 1,1,3", 4)]
    [TestCase("?#?#?#?#?#?#?#? 1,3,1,6", 1)]
    [TestCase("????.#...#... 4,1,1", 1)]
    [TestCase("????.######..#####. 1,6,5", 4)]
    [TestCase("?###???????? 3,2,1", 10)]
    public void CombinationCount(string input, int expected)
    {
        var result = Aoc202312.CombinationCount(input);

        result.Should().Be(expected);
    }

    [TestCase("..???.??.? 1,1,1", 9)]
    [TestCase("?#?##???.???? 2,5,1,1", 3)]
    [TestCase("?#??????##? 1,1,2", 4)]
    [TestCase("?#.#?#??#??? 1,7,1", 1)]
    [TestCase("?#???#?#??.#.###.? 3,1,3,1,3,1", 2)]
    [TestCase("?#......#.?.?. 1,1,1", 2)]
    [TestCase(".????#????? 2,1,2", 7)]
    [TestCase("#.?...?#????#??? 1,7,1", 3)]
    [TestCase("?.#??.??#? 2,1,1", 1)]
    [TestCase(".#???###?#??#???#?.? 7,1,7", 1)]
    [TestCase("?###?.??#??..? 5,4", 2)]
    [TestCase(".#?.??#????#?.?. 2,4,1,1", 4)]
    [TestCase("#.#??????? 1,1,4", 3)]
    [TestCase("#????##.???#???. 1,1,2,1,5", 2)]
    [TestCase("?.?.##???#???##.? 2,7", 1)]
    [TestCase("????.?#?.? 2,2", 6)]
    [TestCase("??.#?????#??#. 1,10", 2)]
    [TestCase("???????.???#?? 6,1,2", 6)]
    [TestCase("#?.#???.?? 2,4,1", 2)]
    [TestCase("?####????.?.?? 4,3,2", 1)]
    [TestCase("?????#???? 6,1", 6)]
    [TestCase("????.???????#?#.? 1,5", 8)]
    [TestCase(".#???##.?#??#??? 6,5", 2)]
    [TestCase("??#?#?????????????. 8,4,1", 19)]
    [TestCase("???.????#?#.???? 7,4", 1)]
    [TestCase("?#???#?.?????????? 2,1,8,1", 2)]
    [TestCase("#?.#?#?.?? 1,3,2", 1)]
    [TestCase("?.??##??????.?. 1,5,1", 15)]
    [TestCase("????#????????#????.? 5,9", 10)]
    [TestCase("?.#?#????? 1,5", 2)]
    [TestCase("??????#.??.??.? 1,5,1,2", 2)]
    [TestCase("##?#??????#.#?#??? 5,1,2,6", 2)]
    [TestCase("????.?##?#..# 2,3,1,1", 3)]
    [TestCase("??.?..???.?#?#? 2,4", 6)]
    [TestCase("???##???.?#??#?# 1,5,6", 3)]
    [TestCase("??.????#?????#?? 1,9", 12)]
    [TestCase("??##?#????.#???.#??? 1,8,4,1,1", 2)]
    [TestCase("##?#???????. 4,1,3", 3)]
    [TestCase("?#???##?????#? 1,1,6,1", 1)]
    [TestCase("????????##?#?????? 1,14", 6)]
    [TestCase("????#????.??? 1,2,1,1", 45)]
    [TestCase("?##.???.#???.#?.??# 3,1,1,4,2,1", 1)]
    [TestCase("?##???????? 2,2,1", 10)]
    [TestCase("?????#??????.??# 1,5,1,1", 31)]
    [TestCase("#?#?????????#.? 5,1,1,2,1", 3)]
    [TestCase(".?.?.??.#. 1,1,1", 5)]
    [TestCase(".?#.??#?#?????###?. 2,12", 2)]
    [TestCase("??.?????#???.???? 1,1,1,4,2", 24)]
    [TestCase("??????#?##?#?? 2,6", 5)]
    [TestCase("..????#?##???? 1,4,1", 10)]
    [TestCase(".?#?#??.#???. 2,1,1,1", 3)]
    [TestCase(".??????#?? 1,1,1", 11)]
    [TestCase("?#?.?#???#???#? 1,4,1,2", 2)]
    [TestCase("??????????#???##?. 1,1,10", 16)]
    [TestCase("???##????.??? 1,4,1,2", 8)]
    [TestCase(".???#??.##???????##? 5,3,1,6", 2)]
    [TestCase("?#??#???.??? 1,1,1", 5)]
    [TestCase(".??..?????#. 1,4,1", 2)]
    [TestCase("???#?????.. 1,3,1", 7)]
    [TestCase("?#???.?#???#?..#??# 2,1,5,1,2", 3)]
    [TestCase("?#??#?.???.#???. 1,3,1,2", 4)]
    [TestCase(".#??#?.???#???#?? 1,1,9", 2)]
    [TestCase("?.?#?##...??? 1,4,1,1", 1)]
    [TestCase("??#?#?#??##???????. 3,3,3,1,3", 4)]
    [TestCase("???#?#?.??#? 6,3", 4)]
    [TestCase("?#?.#??##.#? 1,1,2,2", 1)]
    [TestCase("?????##??#??? 6,3,1", 1)]
    [TestCase("????##???? 1,2", 3)]
    [TestCase("???.???.???.?. 2,2,3", 4)]
    [TestCase("??#????????????# 5,1,1,3", 19)]
    [TestCase("????#?.?..????.??# 2,1,1,2,1,1", 12)]
    [TestCase(".?##?##???? 3,4", 1)]
    [TestCase("?..??????#? 1,1,5", 3)]
    [TestCase("..?????#.?.##?#.?? 4,4", 1)]
    [TestCase("#???.?????? 2,2", 5)]
    [TestCase("?.??#??????.? 1,4,2", 7)]
    [TestCase("?###??#???.?#?.?? 3,1,1,2,1", 8)]
    [TestCase("?????????.????????# 1,1,1,2,4", 138)]
    [TestCase("??#.??#?##.???.???? 1,1,6,3,1,1", 3)]
    [TestCase("???#.###????. 3,4,1", 2)]
    [TestCase("?#.?????????.?# 1,3,3,1", 6)]
    [TestCase("#.???#.????????#?? 1,1,1,2,7", 6)]
    [TestCase("???#?.?????.#? 1,1,4,1", 4)]
    [TestCase("???#..???.? 3,3", 1)]
    [TestCase("?.????#####??#.?#?? 1,1,9,1,1", 2)]
    [TestCase("????#.?#???? 2,1,5", 4)]
    [TestCase(".#?#..#??????????? 3,1,9", 2)]
    [TestCase("?.??..???? 2,1", 5)]
    [TestCase("???????#??.???????.? 1,1,4,1,1,2", 50)]
    [TestCase("..??.??????? 1,1", 29)]
    [TestCase("??.?????##?? 1,6", 9)]
    [TestCase("????????##??.????? 1,7,1,1,1", 21)]
    [TestCase("???.?###???? 1,5", 6)]
    [TestCase("#.?###??#?#???????? 1,4,1,1,3,1", 12)]
    [TestCase("????.???????????? 2,1,7", 37)]
    [TestCase("#?#??#????.?#????? 7,1,1,1", 11)]
    [TestCase("?##???#.?#???#?##??# 3,1,2,4,1", 4)]
    [TestCase("???#??#?????.?##? 7,3", 8)]
    [TestCase("?????????..??? 1,5,1", 19)]
    [TestCase(".???#???.????#.? 5,1,1,1", 16)]
    [TestCase("?#?????#????? 2,3,1", 19)]
    [TestCase(".???#???#???..??##. 5,1,4", 4)]
    [TestCase("?????.?##.# 5,2,1", 1)]
    [TestCase("??#????#?.# 5,2,1", 3)]
    [TestCase("#?.????#???#????? 2,1,2,1,2", 18)]
    [TestCase("????????.??.?????? 7,5", 4)]
    [TestCase("..#?#??###.??????? 8,3", 5)]
    [TestCase("#?.??.??##?.?#? 1,1,5,3", 2)]
    [TestCase(".#????#?#?##?. 1,8", 2)]
    [TestCase("?#?????#.? 1,3", 1)]
    [TestCase(".???.?..#? 1,1,1", 4)]
    [TestCase("??.??.????? 2,1", 15)]
    [TestCase("?#??????#??##?##... 1,11", 1)]
    [TestCase(".#?????????? 1,1,3,1", 10)]
    [TestCase("??#????#?????#??#?? 8,5", 6)]
    [TestCase("?#??#???..##.?? 7,2,2", 2)]
    [TestCase("?.????.#??#?.?##?? 1,1,1,2,5", 14)]
    [TestCase(".?.????????#??##??? 1,2,5,4", 8)]
    [TestCase("?.???##?.????#???## 5,3,4", 2)]
    [TestCase("#..#?##?#?#?????? 1,8,4", 2)]
    [TestCase("?????##?.?#.?? 1,4,2,1", 10)]
    [TestCase("?????????. 4,1", 10)]
    [TestCase("???#??.???????#?. 5,5,1", 4)]
    [TestCase("?.???.?#????##???# 1,1,8,1,1", 4)]
    [TestCase("???????..????? 1,3,4", 12)]
    [TestCase("?#?##??#?????#?#???? 8,6", 8)]
    [TestCase("???#????#.??????..?. 5,3,6,1", 1)]
    [TestCase("?.??##???.??#? 6,2", 4)]
    [TestCase("??.??.???#????#??? 2,1,8", 12)]
    [TestCase("?????##????.#?. 1,1,7,1", 1)]
    [TestCase("??.??#??.?.##? 5,3", 1)]
    [TestCase("???.?#?#??..?? 1,5,1", 12)]
    [TestCase(".#????##?????? 1,7,1", 6)]
    [TestCase(".??????..#?. 1,1,1", 10)]
    [TestCase("#?#??##.?.??. 7,1", 3)]
    [TestCase("?##?#???..?#.???# 4,1,2,1,1", 4)]
    [TestCase("???????#?? 3,3", 9)]
    [TestCase("?.????.#?#??##.??.? 1,1,4,2,1,1", 14)]
    [TestCase("?.?????##?.? 1,1,5,1", 3)]
    [TestCase(".#???.?.?##.?.? 1,1,2,1,1", 3)]
    [TestCase("#.??.?#?#? 1,1,3", 2)]
    [TestCase("?????.?#??#???# 1,1,8", 6)]
    [TestCase(".??#?##??.??.# 1,6,1,1", 2)]
    [TestCase("#??????#??#???#? 1,6,1,2", 5)]
    [TestCase(".??..?#????#???#??? 2,3,7", 5)]
    [TestCase(".??#.??##.?#?.#?#? 1,1,4,1,3", 1)]
    [TestCase("???.??#???.???. 2,1,1,2", 14)]
    [TestCase("?#?..???#??.? 1,2,3", 1)]
    [TestCase("?#??#.#????????.?.?? 1,1,6,1,1,2", 2)]
    [TestCase("#??##?#????.?#???## 1,4,1,1,1,2", 4)]
    [TestCase(".???#?????? 1,2,1", 16)]
    [TestCase("??.?.?##..??#?. 1,2,3", 6)]
    [TestCase("?.#?.#?#??#??#?? 2,3,6", 2)]
    [TestCase("?#??.#??.???????? 1,1,2,6", 3)]
    [TestCase("?#??.#???#???#.??.?? 4,1,6,1,1", 4)]
    [TestCase("##????#?.??????# 4,1,2,1", 4)]
    [TestCase("..?##????.. 3,3", 1)]
    [TestCase(".??#?.???? 3,1", 8)]
    [TestCase("??..????#?.?? 1,2,2,2", 6)]
    [TestCase("?.????.???.#..#? 2,1,1,1,2", 6)]
    [TestCase("??#?##?#??##. 6,3", 1)]
    [TestCase("????????.?????.?.# 1,1,3,1,1,1", 65)]
    [TestCase(".?#?###?#?????.???? 8,2,3", 10)]
    [TestCase(".???##??#?.?? 5,3,1", 2)]
    [TestCase(".?#??##??#.?# 9,1", 1)]
    [TestCase("?##???.??????? 3,1,1,2", 38)]
    [TestCase("?#?#?#?????????????? 6,1,1,1,1,1", 182)]
    [TestCase(".??#??##???#????. 11,1", 6)]
    [TestCase("?#.#????##?? 2,1,1,4", 3)]
    [TestCase("?.?.?.??#?????.??# 1,1,8,1,1", 3)]
    [TestCase("?.??.?????.? 1,1,4,1", 4)]
    [TestCase("?.#???.##.????.??? 1,2,1,2,3,2", 4)]
    [TestCase(".?.#??#??? 1,1,1", 3)]
    [TestCase("?.???????## 6,2", 1)]
    [TestCase("?.?.#?.##???.?. 1,2,2,1,1", 4)]
    [TestCase("???..?.??#???#????# 2,1,1,1,3,2", 10)]
    [TestCase("?????????.??#? 2,1,2", 50)]
    [TestCase(".?.?#.#??#?????#??? 1,1,4,1,1,1", 9)]
    [TestCase("????#??.?#????#??? 4,4,2", 9)]
    [TestCase(".????.?..?.??.?#.?. 1,2", 8)]
    [TestCase("??#?????#?#??.??#??? 1,1,8,4,1", 2)]
    [TestCase("?????????? 1,4", 15)]
    [TestCase("?.?#??.?#?????#? 2,3,4", 6)]
    [TestCase("???.##.??.??? 1,2,1,1", 21)]
    [TestCase(".?.???????#.#.. 8,1", 1)]
    [TestCase("#??.????###??????? 1,1,3,8", 1)]
    [TestCase("??#?#.#??..?? 3,2", 1)]
    [TestCase("#..??.????#???.#?#?. 1,1,5,1,1,1", 6)]
    [TestCase("??.??.???#??.? 2,1,6,1", 2)]
    [TestCase(".????##???? 1,7", 3)]
    [TestCase(".?###?.??.? 4,1,1", 4)]
    [TestCase("?.?#??#?.#..??#??? 6,1,1,1,1", 2)]
    [TestCase(".??????.?# 4,1", 3)]
    [TestCase("##????.?????.?? 6,2,1,1", 6)]
    [TestCase(".?????#.?? 1,3,1", 4)]
    [TestCase("?.????#??#?????? 6,3,1", 4)]
    [TestCase(".????#?.#?.?????#?# 6,2,6,1", 1)]
    [TestCase(".?.???#????###???##? 4,10", 5)]
    [TestCase("?..?#????? 4,1", 3)]
    [TestCase(".??#??.?##.?.#?#?#? 3,3,1,1,1,2", 3)]
    [TestCase("..??#.??????.? 3,1", 7)]
    [TestCase("??????????#?????.. 1,6,1", 53)]
    [TestCase("??#????#?????###?? 7,6", 6)]
    [TestCase("???..#???? 1,1,1", 11)]
    [TestCase("..#?#??...???#?.? 1,1,1,4,1", 2)]
    [TestCase("..#..????#???####. 1,10", 1)]
    [TestCase("?#??????.??? 1,2,1,1", 13)]
    [TestCase("??????.#???. 5,4", 2)]
    [TestCase("??#?#.????? 4,1,2", 3)]
    [TestCase("?#??.??.??#.? 1,1,2,2", 1)]
    [TestCase("#???.??#??#?.?#??##? 1,1,1,5,7", 2)]
    [TestCase("???.??#?.?#?? 1,4,1", 3)]
    [TestCase(".??????#???#????#?. 3,5,6", 1)]
    [TestCase("???????#?? 2,2", 9)]
    [TestCase("#??#?#?###?..??#???? 1,4,4,1,3", 2)]
    [TestCase("?##??????#?##???? 4,2,7", 4)]
    [TestCase("???????..?.#???? 5,1,1,4", 1)]
    [TestCase("?????????#???#??? 1,1,1,7,2", 4)]
    [TestCase("?.##.???????#???. 2,6,1,1", 2)]
    [TestCase(".?##?#?.?#?..?. 5,3", 2)]
    [TestCase(".????.?.?. 2,1", 7)]
    [TestCase("??#??#?.????.??..? 5,2,2,1", 6)]
    [TestCase("????##?#???. 1,3,1,1", 4)]
    [TestCase("#?.??##?###.??#? 1,1,6,1,2", 1)]
    [TestCase("?.?.?#?.#?.? 1,3,1,1", 2)]
    [TestCase("?????????##???##???. 2,2,3,6", 22)]
    [TestCase("#????????.???##.? 4,4,5", 1)]
    [TestCase("???????..???? 5,1,3", 2)]
    [TestCase("??.????##????###??? 2,1,5,5,1", 5)]
    [TestCase("??...??#????#???. 2,8,1", 3)]
    [TestCase("???#??????? 1,3,2", 11)]
    [TestCase("????.??..?.?? 2,1", 19)]
    [TestCase(".???.#?????. 1,6", 3)]
    [TestCase("??#?????#.??.#?? 3,1,1,1,1", 25)]
    [TestCase("##?.???##????????? 2,4,1,2,1", 15)]
    [TestCase("???###??##?.?.?.???? 9,2", 6)]
    [TestCase("???#????.? 1,6", 1)]
    [TestCase("??#???#?..#.#?? 5,2,1,3", 1)]
    [TestCase(".??#????????#? 8,1", 3)]
    [TestCase("?.?#??#????#??? 1,5,1,2", 7)]
    [TestCase("???..?.????#???#.? 1,1,1,3,1,1", 37)]
    [TestCase("????##???.#?#?. 4,4", 3)]
    [TestCase("??#?.#???? 3,2", 2)]
    [TestCase("?.#??#???#????? 1,6,1,1,1", 3)]
    [TestCase("??????#?#??#?.???? 1,1,7,1,1", 27)]
    [TestCase("?.?????.?. 2,1,1", 3)]
    [TestCase(".??##?.?#???? 2,2", 2)]
    [TestCase(".#??#??#?????.??#.? 1,5,2,2", 5)]
    [TestCase("?.??#?.???# 3,1,2", 2)]
    [TestCase("?..???????? 1,5", 7)]
    [TestCase("#?????????#?#??.?#. 2,1,2,7,2", 1)]
    [TestCase("?.?????##.?#??# 1,2,2,2,1", 8)]
    [TestCase("?????.??##. 2,4", 4)]
    [TestCase("??##??#??.?#?????. 1,6,6", 2)]
    [TestCase("???###???? 5,1", 6)]
    [TestCase("###???#???.????????. 4,1,1,1,2,1", 21)]
    [TestCase("??.???#.?#?. 2,3,1", 1)]
    [TestCase("?#?.??#?.?#????#?? 1,2,1,3", 6)]
    [TestCase("?????????#?? 1,7", 9)]
    [TestCase("??????????????????.? 1,5,4,4,1", 5)]
    [TestCase("?#.?.???#?? 1,5", 2)]
    [TestCase("?###?????#??? 5,2,3", 1)]
    [TestCase("?.???#???#??????. 1,1,4,2,1", 7)]
    [TestCase("?????#??####.##??#? 6,4,2,3", 2)]
    [TestCase("???.#???.???#???? 4,4", 4)]
    [TestCase("??#?.#?###????? 1,6,2", 2)]
    [TestCase("??????#?#?#???.????? 2,8,3,1", 10)]
    [TestCase(".?????.???????????? 1,4,3", 85)]
    [TestCase("?????.?##???? 4,3", 4)]
    [TestCase("???#???.??#??? 4,1,4", 13)]
    [TestCase("#?????.?.#. 3,1,1", 3)]
    [TestCase(".?##???##?#??????. 2,1,4,1,1,1", 1)]
    [TestCase("??????#?.????. 6,3", 4)]
    [TestCase("?.???#?#?#??.#??# 2,1,5,1,1", 1)]
    [TestCase("???##?##?.?.??#.? 8,3", 2)]
    [TestCase("???#???????..?? 1,1,1,2,1", 28)]
    [TestCase("??#???#.??#??..??? 7,1,3,1", 3)]
    [TestCase("????#?.?.#.?? 5,1,1,1", 4)]
    [TestCase("#??##.?#????#???? 1,2,1,5,1", 3)]
    [TestCase("???#.????..?##?? 4,1,2,1", 4)]
    [TestCase("???#?????.??.????# 5,1,1,1,2", 28)]
    [TestCase("????.?.??#?????#? 1,1,1,1,8", 3)]
    [TestCase("???#???#??## 2,5,2", 1)]
    [TestCase("#.????#?.?#????????? 1,5,1,1,1,1", 40)]
    [TestCase("##?#?#?.?? 6,1", 2)]
    [TestCase(".#?#??????#????.?? 1,2,3,2,1", 10)]
    [TestCase("?#?????.#?? 7,2", 1)]
    [TestCase("???#????.?. 1,4", 3)]
    [TestCase("?.#.?.???.##.## 1,1,2,2,2", 4)]
    [TestCase("???????.?.??#??#.? 2,4", 6)]
    [TestCase("????.???.#?? 2,2,1,1", 6)]
    [TestCase(".??#?#?????#?#??#? 5,3,4,2", 1)]
    [TestCase("##?????????.?????? 6,2,2,2", 9)]
    [TestCase("???#???????? 1,1,2,1", 24)]
    [TestCase("???????????..??#? 2,1,1,1,3", 70)]
    [TestCase("?????.??.???? 5,1,3", 4)]
    [TestCase("?????????..?# 1,2,2,1", 10)]
    [TestCase("??????????.?#..?? 3,4,2", 6)]
    [TestCase("???#?#?????#..????? 9,3", 3)]
    [TestCase("??????.?#??#???#? 1,4,1,6", 2)]
    [TestCase("??#?#????.??? 5,1", 15)]
    [TestCase("???#.?#?????##. 3,9", 1)]
    [TestCase("?????#???.????#? 2,1,4,1,3", 3)]
    [TestCase(".??#???..???? 6,3", 2)]
    [TestCase("?#.?#..??. 1,2,2", 1)]
    [TestCase(".????????.? 1,2,1", 25)]
    [TestCase("??.?#??.???? 1,2,1,1", 20)]
    [TestCase(".?..#?.??.?.??? 1,1,2,1,1", 4)]
    [TestCase("???#?#????###???? 2,1,3,4,2", 3)]
    [TestCase("????..??## 1,2,4", 1)]
    [TestCase("????????..???#????#? 1,3,1,9", 8)]
    [TestCase("??#????.##?..??? 5,2,2", 6)]
    [TestCase("???????##.???#?. 3,5,3", 2)]
    [TestCase("?#???.???????? 4,8", 2)]
    [TestCase("???????#???..#?.? 4,5,2,1", 3)]
    [TestCase("???.??##????.#??.? 1,8,1,1,1", 3)]
    [TestCase("??.?###???.??#.?? 1,6,1,1,1", 8)]
    [TestCase("???.##??#?#? 3,7", 1)]
    [TestCase(".??.???????????? 1,6,5", 2)]
    [TestCase("?#?#?.??.??.??? 5,1,1,1", 16)]
    [TestCase("?????#????#???#??#. 5,2,5", 7)]
    [TestCase("??#?#?.??#??#??????# 4,13", 2)]
    [TestCase("#??#????.???## 8,1,2", 2)]
    [TestCase("????.????. 2,2", 9)]
    [TestCase("#??#???#?????#? 4,3,3", 6)]
    [TestCase("#?????#.#?.? 2,2,1", 1)]
    [TestCase("#???.??.#.#? 3,1,1,1", 2)]
    [TestCase("???????#?.?#??## 2,2,5", 9)]
    [TestCase("???##?.#???????#. 2,3,4,3", 1)]
    [TestCase("?#??.???.#. 3,2,1", 4)]
    [TestCase("#?##?.?????.#?#?# 5,2,1,5", 3)]
    [TestCase("???#????#.?????? 4,1,1,2,1", 22)]
    [TestCase("#.?.?##?#?#???#? 1,11", 2)]
    [TestCase("?.??.?#??##?? 1,7", 6)]
    [TestCase("?????#..#?.##?#????? 1,2,1,4,3", 6)]
    [TestCase("#????.?##????##??# 1,1,4,5", 6)]
    [TestCase("?#????.???##? 3,5", 4)]
    [TestCase("?#?.??????? 3,1,1", 15)]
    [TestCase(".#.???#...#??. 1,3,3", 1)]
    [TestCase("?#?...???#? 2,1,1", 4)]
    [TestCase("??.#??.???..? 1,3,1,1", 8)]
    [TestCase(".?????.#?? 5,1", 1)]
    [TestCase("#?????#.##?#?????? 2,4,7,1", 2)]
    [TestCase("?.????.??#??#??#??.. 3,1,1,6", 4)]
    [TestCase("??????????? 2,7", 3)]
    [TestCase("?.????..?#?# 2,4", 3)]
    [TestCase("?????#..?#????# 1,1,1,3,2", 6)]
    [TestCase("??.#????###???????#? 9,4", 2)]
    [TestCase("?#??.##?.??.??????? 2,3,1,2,2", 26)]
    [TestCase(".#?##.?#??# 1,2,5", 1)]
    [TestCase("??###?#?#??????.?#? 1,8,2,1,2", 2)]
    [TestCase("?#.###???#??????? 2,11,1", 2)]
    [TestCase("?.?.????#??#?# 1,1,1,3", 8)]
    [TestCase("?????.??#???#? 3,2,2", 12)]
    [TestCase("?#..???.??##???#?? 2,2,3,1,1", 6)]
    [TestCase("??#?#..?#???? 3,1", 1)]
    [TestCase("?????????.? 2,1,1", 41)]
    [TestCase("??#?#?.?#?. 5,2", 4)]
    [TestCase("#????#?????#.??. 8,1,1,1", 2)]
    [TestCase("#???#?#???.##..?#. 8,2,1", 1)]
    [TestCase(".#.?#?##??.?..??.?#? 1,5,1,1,1,3", 2)]
    [TestCase("???#????.???.# 5,1,1,1", 13)]
    [TestCase("?#??..???#. 3,3", 2)]
    [TestCase("????#?????#..??#? 1,2,5,1,1", 2)]
    [TestCase("..???????##???? 3,5,1", 10)]
    [TestCase("??#?##.???#??? 5,3", 3)]
    [TestCase("??#?????????##?##?? 5,5,2", 3)]
    [TestCase(".#???????? 7,1", 1)]
    [TestCase("?.?.#.?#???????? 1,1,1,5,1", 9)]
    [TestCase("??##...??#?. 3,3", 2)]
    [TestCase(".??????#??? 2,1,1", 11)]
    [TestCase("#??.??????.? 3,1,1", 16)]
    [TestCase("..?..?..?????#? 1,3", 9)]
    [TestCase("??#.???????#??? 2,1,6,1", 4)]
    [TestCase("???#??.??. 3,1", 7)]
    [TestCase(".##???...#????##? 5,7", 1)]
    [TestCase("??###????.?????? 8,4", 6)]
    [TestCase("??##??..??.?# 6,1,2", 2)]
    [TestCase("?????#.??# 1,1,1", 5)]
    [TestCase("??#?????.?#??????? 4,1,1,4,2", 5)]
    [TestCase("??##??..??? 6,2", 2)]
    [TestCase("##?##??#?????#??#.# 11,1,2,1", 1)]
    [TestCase(".?##?#.?#. 5,1", 1)]
    [TestCase("?????#??????##? 1,11", 5)]
    [TestCase("????#????????####? 2,1,6", 20)]
    [TestCase(".?.?#???????? 6,1", 5)]
    [TestCase("???#?#????.??#?? 5,1", 3)]
    [TestCase("#??#.???##?????#? 1,1,6,1,3", 1)]
    [TestCase(".??.?#???????# 1,4,1,2", 6)]
    [TestCase("??????#???..??#?#?? 4,5", 12)]
    [TestCase("?????.?..????##?#. 2,8", 4)]
    [TestCase("?????.#.?#?? 4,1,3", 4)]
    [TestCase("?????#???.??.??# 1,1,2,1,3", 21)]
    [TestCase("?#??????.??#???#??? 1,1,2,4,4", 9)]
    [TestCase(".???#?#???. 1,1,3", 2)]
    [TestCase("????.??###??? 1,1,3,1", 14)]
    [TestCase(".?#????#?##?#.? 2,5,1", 2)]
    [TestCase("..?.????.?.??#??? 1,3", 19)]
    [TestCase("???##?????.. 3,1", 7)]
    [TestCase("##???????????#?? 8,2,1,1", 2)]
    [TestCase("????###?????##?..? 1,1,6,4,1", 1)]
    [TestCase(".?????????#??#??#?? 10,2,2", 4)]
    [TestCase("?#.??????? 1,1,1", 15)]
    [TestCase("#.????????## 1,1,1,2", 15)]
    [TestCase("??#?.??????#.?.???? 3,2,1,1,1,1", 66)]
    [TestCase("?#?.#??#??????.????? 2,7,1,4", 8)]
    [TestCase("?##??#????##?#?.##?? 2,3,3,2,4", 2)]
    [TestCase("#..#?.??#??#?? 1,1,6,1", 1)]
    [TestCase("#.???..???????? 1,1,1,4,3", 1)]
    [TestCase("?##????.?? 2,1,1", 7)]
    [TestCase(".?#??..##????..?? 2,6,2", 2)]
    [TestCase("..#?.##???. 2,4", 1)]
    [TestCase("#?.???#.?? 1,2,2", 1)]
    [TestCase("???##??????.??. 1,5,1,1", 15)]
    [TestCase("?#???#??#.????? 9,1", 5)]
    [TestCase("????#.???? 5,1,1", 3)]
    [TestCase("#??????.#???#???# 1,2,1,7,1", 3)]
    [TestCase("#?????##??#????.???? 3,8,1,1", 21)]
    [TestCase("?.#????##?#??.?..?? 1,2,8,1,2", 1)]
    [TestCase("#???????.??#? 1,2,4", 5)]
    [TestCase("??###??.?.? 6,1", 4)]
    [TestCase(".??????#.??? 1,1,1,3", 6)]
    [TestCase(".??#??###???#?..?#.. 9,1,1", 2)]
    [TestCase("?.?.??##?# 1,6", 2)]
    [TestCase("????#?????# 1,2,3", 5)]
    [TestCase("??##??????##??# 11,2", 1)]
    [TestCase("?#?????#?? 1,2,1", 3)]
    [TestCase("#.#??.???#.##????#? 1,2,2,1,8", 1)]
    [TestCase("?#.??#?????? 1,3,1,1", 10)]
    [TestCase("..???????.? 3,2", 3)]
    [TestCase("#??.?.???????? 3,1,1,1", 41)]
    [TestCase("??##???#???# 8,1", 3)]
    [TestCase("#????.?#??#????#.. 1,1,1,1,3,1", 2)]
    [TestCase("?####?#???.?.? 8,1", 5)]
    [TestCase("..#.???#??.. 1,4", 3)]
    [TestCase(".??.?#??????#???? 1,9,2", 6)]
    [TestCase("?#?.?????? 3,4", 3)]
    [TestCase("#??.#?????????? 2,2,3,3", 3)]
    [TestCase("??#????.???. 5,1,1,1", 1)]
    [TestCase(".??#???#.??#?. 3,1,3", 6)]
    [TestCase(".?#??#.#?.?#?.# 2,1,1,2,1", 4)]
    [TestCase("??????????.?????. 8,2", 12)]
    [TestCase("?.???.??.?? 1,1", 24)]
    [TestCase("#?.?????##..###? 1,1,4,4", 2)]
    [TestCase("?.#??.????.##? 2,3,2", 2)]
    [TestCase("????#????? 1,2,2", 12)]
    [TestCase("?###?.#???? 4,2", 2)]
    [TestCase(".?.?.????.?.#?? 1,1,1,1,3", 13)]
    [TestCase(".??#???.???#??##???. 4,5", 3)]
    [TestCase("..??#??#..##?#. 4,2,1", 1)]
    [TestCase("?##???##??.??????.?? 8,2,2", 16)]
    [TestCase("#??#?????#?#. 1,5,1,1", 2)]
    [TestCase("???.?????#??. 1,1,4", 22)]
    [TestCase("..???##??#??.?? 7,1", 7)]
    [TestCase("??.#.?????.??????#? 1,1,1,2,1,2", 118)]
    [TestCase("?#.#?.#????##??##? 2,1,1,1,2,2", 2)]
    [TestCase("?##?.?..##???? 3,1,4", 2)]
    [TestCase("????..?#??#.? 3,5", 2)]
    [TestCase(".#?##???.?#.. 6,1", 1)]
    [TestCase("?.?.???..#????? 1,1,1,2,1", 23)]
    [TestCase("?.#???#????#?#?### 1,12", 1)]
    [TestCase("??.?#?#..?#??.???? 3,3,1", 8)]
    [TestCase("???#?##?## 1,7", 2)]
    [TestCase("#???????.#.#..#? 6,1,1,1", 1)]
    [TestCase("????????.????#?? 2,2,1,1,3", 34)]
    [TestCase("?????.?#?#?#?????## 2,2,5,1,3", 2)]
    [TestCase("??????#.???? 1,4,1,1", 6)]
    [TestCase("?????#??.##?. 1,2,3", 7)]
    [TestCase("?????#???.???.? 1,6,1", 12)]
    [TestCase("?#??.??#????#??##? 3,11", 4)]
    [TestCase("??#?.#??#???? 2,4", 2)]
    [TestCase("..??#????.??? 2,1,1,1", 8)]
    [TestCase("??????#?#??..? 2,3,1", 11)]
    [TestCase("?#?#??.??###????? 4,5,1", 18)]
    [TestCase("???#??##?#??.?.??#? 1,1,6,1,1,1", 4)]
    [TestCase("##?.#.?.#??#.#? 3,1,1,2,1", 1)]
    [TestCase("?##??.?.?????#? 3,2,3", 6)]
    [TestCase("?##?#???##???#.#?#? 12,1,1,1", 1)]
    [TestCase("???#?#?.?#???. 4,3", 4)]
    [TestCase(".????##??. 2,2", 2)]
    [TestCase("??#???#??#?????????. 1,8,3,1,2", 1)]
    [TestCase("?#????#... 2,3", 2)]
    [TestCase("??.??#???? 1,3,1", 13)]
    [TestCase("?#?.????????#? 1,3,1,1", 6)]
    [TestCase("?..??#?.#.????? 4,1,1,2", 3)]
    [TestCase("?????.????#?????.?. 5,7,1,1", 3)]
    [TestCase("??.?#?.?##???#??#? 2,2,8,1", 2)]
    [TestCase("?????.#??#??#?????? 1,1,2,1,7", 12)]
    [TestCase("??.?????.#? 1,4,1", 4)]
    [TestCase("?#?#???..##?? 5,3", 2)]
    [TestCase("?.?.??????. 1,2,1", 13)]
    [TestCase("?#?#.?#?#???????.# 2,1,7,1,1", 5)]
    [TestCase("??????????????#???? 2,1,1,9", 35)]
    [TestCase("#?.???.??. 1,1,1", 7)]
    [TestCase("#?.?????#??.##?#? 1,1,4,5", 6)]
    [TestCase("?.????#??.? 3,1", 5)]
    [TestCase("???#??##????##??.?. 1,1,11,1", 2)]
    [TestCase("??#????????#? 1,4,1,1", 4)]
    [TestCase("???#...?.? 2,1", 3)]
    [TestCase("?#????##??#????. 1,1,2,5", 4)]
    [TestCase("?.?.#???????.#?.??. 4,2", 1)]
    [TestCase(".???.#?#?????#???#? 1,1,8,3", 3)]
    [TestCase("?.??.?.?.??# 1,1,1,3", 7)]
    [TestCase("#?..#?.?#? 2,1,1", 1)]
    [TestCase("?.????.#??#? 1,1,1,2", 14)]
    [TestCase("?#???????? 2,2,1", 16)]
    [TestCase(".?????.???.??????.. 3,1,1", 106)]
    [TestCase(".?#?.##?##. 1,5", 1)]
    [TestCase("??#????...?##. 6,2", 2)]
    [TestCase("??..#??#??????????. 1,14", 2)]
    [TestCase("#?.#?????##.#???.#.? 1,8,1,1,1,1", 2)]
    [TestCase("#????##???.????.?? 1,1,6,1,1,1", 6)]
    [TestCase("????#.???? 5,1", 4)]
    [TestCase("?##?#???####?#?? 4,1,7", 1)]
    [TestCase("?.?????.?#??.#? 1,4,2,1", 4)]
    [TestCase("??#?.?????. 2,1,1", 12)]
    [TestCase("???.?#???? 1,3", 7)]
    [TestCase("##?????#?#?.#??#?# 2,1,4,1,1,1", 5)]
    [TestCase("?#????.#??##.#?? 3,1,5,1", 3)]
    [TestCase(".?#.?#.#?.?? 2,1,2,2", 1)]
    [TestCase("??.????.#? 1,2,1", 7)]
    [TestCase("??..????#.?? 2,1,1", 9)]
    [TestCase("??.?.?#?#.???? 1,1,3,2", 6)]
    [TestCase("?#??.????#? 3,6", 2)]
    [TestCase("?????#????###?? 3,4", 6)]
    [TestCase("?##??.#????????#??? 4,1,4,1,2,1", 2)]
    [TestCase("??##?#??????????. 1,11,2", 1)]
    [TestCase("#?.??????#??#?#??##? 1,15", 2)]
    [TestCase("#?..???##?.#? 1,1,2,1", 2)]
    [TestCase("?.?????#??#???.? 1,6,1", 24)]
    [TestCase("?##??????#?.? 6,2", 4)]
    [TestCase("..?###??..?.????. 5,4", 2)]
    [TestCase("???#??..?.#. 3,1,1", 4)]
    [TestCase("??#??#???###.?#?? 12,2", 2)]
    [TestCase("?.?#..?#.? 1,2", 1)]
    [TestCase("##??#?????? 2,1,1", 5)]
    [TestCase("#?#?.#??#?.?# 4,4,1", 1)]
    [TestCase("???#??#.?? 1,2,1", 5)]
    [TestCase("?#?.??.???# 2,1,2", 6)]
    [TestCase("?#??#??#???.?.?#??? 10,2", 4)]
    [TestCase("?????.##?#???? 1,2,5,2", 3)]
    [TestCase("?.?.?#??????##. 1,3,4", 4)]
    [TestCase(".#??..????#..#.??? 1,2,2,1,1,1", 1)]
    [TestCase(".?..?#?..????? 3,1", 5)]
    [TestCase("??????????.??. 7,2", 5)]
    [TestCase("??.?#?###.??? 1,5,1", 6)]
    [TestCase(".???#??.??#??. 2,1,5", 2)]
    [TestCase("?#???????.??#? 2,2,4", 9)]
    [TestCase("#?#????.???#?? 5,2", 2)]
    [TestCase("?#??#???????#?.#?? 1,1,4,1,1,1", 2)]
    [TestCase("#?#??##..?#????#??. 7,1,3", 3)]
    [TestCase("?##???.#?. 2,2,1", 1)]
    [TestCase(".??.????#??#???? 1,7,1", 16)]
    [TestCase("?#?.??##?..??? 2,4,2", 8)]
    [TestCase("..?#??.??. 2,1", 5)]
    [TestCase("??????????????.???. 4,2", 58)]
    [TestCase("#.?#?#????#???#?.?? 1,1,11,1", 2)]
    [TestCase("??#??.#?..#?#. 1,2,1,3", 1)]
    [TestCase(".??????#?#?#??. 2,1,1,1,1", 7)]
    [TestCase("?.???.???##???? 2,1,4", 6)]
    [TestCase("??.??????.. 3,1", 3)]
    [TestCase(".?#?????#?#??..? 1,6", 3)]
    [TestCase(".?#?????????? 3,3", 11)]
    [TestCase(".??..#??.???? 1,3,2", 6)]
    [TestCase("??#?###??#??. 2,8", 1)]
    [TestCase("?.??##???#??#?.?? 1,5,6,1", 2)]
    [TestCase("????????#?? 2,1,4", 10)]
    [TestCase("??###?????? 4,2", 7)]
    [TestCase("?.###?????#???#. 3,2,1,3", 2)]
    [TestCase("#????#????? 1,4,2", 6)]
    [TestCase("????...??????#???.?? 1,2,1,1,6,1", 2)]
    [TestCase("??????#??#?.?.???# 1,1,7,1,3", 1)]
    [TestCase("??#.??#??? 2,5", 2)]
    [TestCase(".?##???#????##???#? 4,2,2,2", 6)]
    [TestCase("?#??#.??.???#?????#? 4,1,1,2,1,2", 22)]
    [TestCase("??.??????????.? 1,1,1,2,1", 116)]
    [TestCase("??.????#.????#? 1,1,6", 5)]
    [TestCase("??#??#?????? 7,2", 6)]
    [TestCase("???.??????#??????? 3,2,4", 27)]
    [TestCase("#?#?#?#?????.???? 1,1,8,1,1", 3)]
    [TestCase("???????#?????##????. 1,9", 13)]
    [TestCase("??.??.???##??.????.# 2,2,5,2,1", 9)]
    [TestCase("???#....#? 2,1", 1)]
    [TestCase("??##?.??????#.. 1,2,1,1,1", 6)]
    [TestCase("#?????##?#????#?. 5,5,1", 1)]
    [TestCase("???.#.????.???????? 2,1,1,1,3,1", 92)]
    [TestCase("#????.#????.????. 1,1,4,4", 3)]
    [TestCase("?????###???#??.#? 3,4,2,1", 6)]
    [TestCase("??.??#??????? 2,1,1", 23)]
    [TestCase("???..#???# 1,1,1", 4)]
    [TestCase("???????????????? 2,1,1,2,1", 252)]
    [TestCase("???##?????? 2,1", 5)]
    [TestCase("??????##????#???? 7,1,1,1", 13)]
    [TestCase("#?#?..???#?##? 4,5", 2)]
    [TestCase("#.????#?.????#.?? 1,2,1,5", 2)]
    [TestCase(".???.?????...?#?.?? 1,2", 17)]
    [TestCase("?#?.?#????????.???## 2,4,3,5", 10)]
    [TestCase(".??#.#????#?#????#?? 3,2,9,1", 1)]
    [TestCase("??####.???#?##?? 5,1,2,4", 1)]
    [TestCase("??????????#?#?#?? 1,1,1,2,3", 20)]
    [TestCase("?#?#?????###???##.. 4,2,8", 3)]
    [TestCase("???#??.?????#?? 1,2,1,4", 21)]
    [TestCase("?.???##???. 1,3,1", 7)]
    [TestCase("?#?#????#???#? 1,6,4", 1)]
    [TestCase("?.?#?.?????#??? 3,4", 4)]
    [TestCase("???##??#?## 1,2,4", 2)]
    [TestCase("?#?????????.?? 5,1", 13)]
    [TestCase(".??##????#?#?????? 2,6,1,1", 10)]
    [TestCase("?#??#??##. 1,5", 1)]
    [TestCase("?.????.??#?. 1,1,1,1", 10)]
    [TestCase("???#???.??#???#??#? 4,10", 8)]
    [TestCase("#???#?#.????????#? 7,1,1,1", 15)]
    [TestCase("#????#?#?? 4,3", 1)]
    [TestCase("???.??.?????? 1,2,3", 17)]
    [TestCase("??.#.??????##??? 1,1,1,1,6", 8)]
    [TestCase("??????.???? 4,1", 13)]
    [TestCase("?.?#??.#??. 3,1", 2)]
    [TestCase("?.##???#????#??????? 3,1,1,3,2", 11)]
    [TestCase(".?????#????.??#?.?. 3,1,3,1,1,1", 2)]
    [TestCase("?#??#??????#? 1,3,5", 3)]
    [TestCase("???#?.?.?. 5,1,1", 1)]
    [TestCase("##..??#??##?? 2,8", 2)]
    [TestCase("?????#????# 2,3", 2)]
    [TestCase("?#.???###?????.. 1,7", 4)]
    [TestCase("?###???#??##??# 8,5", 2)]
    [TestCase("??.?.?#????? 1,1,2,2", 10)]
    [TestCase("?#?.??.?#? 3,1", 1)]
    [TestCase("????????.????#?#.?# 1,2,1,6,1", 10)]
    [TestCase("??##...????.????#?. 3,1,5", 8)]
    [TestCase("????..???.?..? 3,1,1", 17)]
    [TestCase(".#???.###?#?? 2,3,2", 1)]
    [TestCase("?##?#??????.?...# 4,2,1,1,1", 3)]
    [TestCase("???#?????#.? 1,4", 1)]
    [TestCase("??.??#??..????. 1,3,1,4", 2)]
    [TestCase(".##?..??.?#?? 2,1,3", 4)]
    [TestCase("???##.?.?.?????#?? 1,2,1,3,2", 12)]
    [TestCase("??#??#?.?????????. 5,2,5", 6)]
    [TestCase("#??????#.??#?? 1,2,1,3", 10)]
    [TestCase(".??#???????? 7,2", 3)]
    [TestCase(".#?#?.??#.? 3,2", 1)]
    [TestCase("????##?##??..???. 9,2", 6)]
    [TestCase(".????.???#? 3,4", 4)]
    [TestCase("?.??#??###?#?#?. 9,2", 1)]
    [TestCase("???#???.?? 2,1", 8)]
    [TestCase(".?.??????? 1,2,2", 7)]
    [TestCase("??????????.#? 1,5,1", 10)]
    [TestCase("?????#?.???#??.??? 1,4", 3)]
    [TestCase("??#??.##.?? 3,2,1", 6)]
    [TestCase("???#???#??#?#????? 3,2,5,1,1", 2)]
    [TestCase("?#???????.. 4,2", 5)]
    [TestCase(".?????#????.?#?? 5,3", 10)]
    [TestCase("?..????##????????? 6,4", 15)]
    [TestCase("?????#?.?.??.#?? 3,3", 2)]
    [TestCase("???#???.#?#?.?#??? 1,2,1,1,2,3", 8)]
    [TestCase("#????.??#??. 4,1,3", 1)]
    [TestCase("???#??????#???##? 4,9", 7)]
    [TestCase("??.?..#?.????.. 2,1", 5)]
    [TestCase("#??#.??.#????#? 1,1,2,7", 1)]
    [TestCase("???.?#.?..?.?? 2,2,1,2", 4)]
    [TestCase("?.?#?##??.#.#?.?#. 1,5,1,1,1,2", 1)]
    [TestCase("?#?#??##???#???? 11,1", 3)]
    [TestCase(".????..#???##? 2,1,1,2", 4)]
    [TestCase("#??.??##?.?.??#??#? 3,4,1,3,3", 2)]
    [TestCase("##??.?#?.###? 2,2,3", 2)]
    [TestCase("?#???????????### 1,1,1,1,3", 35)]
    [TestCase(".?#?##???##??????? 4,4,1", 15)]
    [TestCase("?.????????#????? 2,2,6", 10)]
    [TestCase("?#??.?..######?# 2,1,8", 3)]
    [TestCase("???.??.???##..???#? 1,2,1,2,1,2", 18)]
    [TestCase("...##??.#?.?? 4,1,1", 2)]
    [TestCase("?.#?..??.? 2,2", 1)]
    [TestCase("?##??..?##???? 4,2,3", 2)]
    [TestCase("???#?#??????.?#??? 8,4", 8)]
    [TestCase("?#.?????##.??#? 1,2,4,2", 2)]
    [TestCase("???#.#???##?.# 3,2,2,1", 1)]
    [TestCase("?????????????..?.? 1,6", 21)]
    [TestCase("#???????.?# 4,2,1", 2)]
    [TestCase("???????#??? 2,1,3", 10)]
    [TestCase(".???.######?.? 1,6", 3)]
    [TestCase("??.??????. 2,1,1", 11)]
    [TestCase("?#????.????#?#.?.??# 3,7,3", 2)]
    [TestCase("??#??.????? 3,2", 12)]
    [TestCase("???#?????????????#?? 10,6", 9)]
    [TestCase(".?.????.???. 1,2,1,1", 7)]
    [TestCase("??.????#.?#?? 1,2,1,2", 8)]
    [TestCase(".?.???..?# 1,1,1", 4)]
    [TestCase("?#?...?##??? 2,2", 2)]
    [TestCase("##??##??#?.?.??. 10,1", 3)]
    [TestCase("??#??????????.?.??? 12,1,1", 8)]
    [TestCase("?????#?#???#????.?# 1,11,1", 10)]
    [TestCase("?.???.?.??? 2,3", 2)]
    [TestCase("??..?#?#??#???#?? 1,2,9", 2)]
    [TestCase(".#???..??## 3,1,2", 1)]
    [TestCase("?##?#??.?.????????. 6,1,1,1,1", 50)]
    [TestCase("??????#?????#??.?? 1,13,1", 2)]
    [TestCase("#?..????.#???#?? 2,1,6", 4)]
    [TestCase(".???#??..#? 4,2", 3)]
    [TestCase("????..?#?? 1,2", 8)]
    [TestCase(".??#????????.#.?? 8,1,1,1", 6)]
    [TestCase("#??.??.?#. 2,1,2", 2)]
    [TestCase("??#.?.??????##?? 1,1,4,3,1", 2)]
    [TestCase("??.??.?#?.?????#?? 2,1,1,2,3", 14)]
    [TestCase("?#????????#?.?#. 10,1", 1)]
    [TestCase("??.????????? 1,5,2", 6)]
    [TestCase("?????.?.???#???.?.?? 2,6", 8)]
    [TestCase(".?####?#?#???#??? 8,3,1", 3)]
    [TestCase("?????##.?#????.??.? 1,4,2,2,1,1", 12)]
    [TestCase(".?????????#??????#? 3,10", 9)]
    [TestCase(".??.????## 1,2,2", 4)]
    [TestCase("?.##.?.??##?.? 2,5", 1)]
    [TestCase("?????#???? 7,1", 3)]
    [TestCase(".?#...?.#. 1,1,1", 1)]
    [TestCase(".???##.???#.?.##?. 5,1,3", 1)]
    [TestCase("?.?????..?..# 1,2,1,1", 10)]
    [TestCase("??#??????#?? 4,4", 8)]
    [TestCase("?????#??.?. 4,1", 5)]
    [TestCase("???#?.?#?#??.? 2,1,5,1", 2)]
    [TestCase("??????.????. 1,1,1,2", 22)]
    [TestCase(".?.???#.#?????#?? 1,3,1,2,3", 3)]
    [TestCase("????#??????#??.??#? 12,1", 3)]
    [TestCase("??...?..??????#.?? 1,1,6,1", 4)]
    [TestCase(".?.??.???.?#?? 1,2,3", 14)]
    [TestCase("?.????#?????#?##??? 1,13", 10)]
    [TestCase("?.???#?##???.#..??? 1,1,1,4,1,1", 6)]
    [TestCase("?.#?##???#??#.?? 1,9,1,1", 2)]
    [TestCase("??#?.?#??#.? 1,5", 1)]
    [TestCase("??.#?????..????#???? 1,1,3,8", 8)]
    [TestCase("???#?#?#???#?.??# 1,10,2", 3)]
    [TestCase(".????##??? 1,5", 6)]
    [TestCase("???#??..?.? 6,1,1", 1)]
    [TestCase("?.?.????????#???? 1,1,3,1,5", 12)]
    [TestCase("????????#?..?????? 5,2,6", 5)]
    [TestCase("?????????#????#.?# 2,5,1,2", 18)]
    [TestCase(".???????#??#?? 2,6", 12)]
    [TestCase("#??..?##.?? 3,2", 1)]
    [TestCase("?????????#?#??#?#. 2,5,4", 5)]
    [TestCase("?#??.?.?#??? 4,1", 1)]
    [TestCase("###?????##.?.#?#... 10,3", 1)]
    [TestCase("???#?##?.???#?#????? 2,5,2,1,3", 3)]
    [TestCase("??#?.??.??#.##???#.. 4,1,1,1,4,1", 2)]
    [TestCase("??#???.??????.? 3,1,2,1,1", 24)]
    [TestCase("??#???#.??##????? 1,2,2,7", 3)]
    [TestCase(".?#??.????##??#?.?? 3,7", 4)]
    [TestCase("?.???.???? 1,1,3", 8)]
    [TestCase("?????.???????????### 1,1,1,1,1,5", 166)]
    [TestCase("?.?.?????#?..??#?#? 1,1,1,1,1,6", 3)]
    [TestCase("?.#.?.?????#?#?#?#?# 1,14", 1)]
    [TestCase("?..##???#??#??#????? 1,4,12", 1)]
    [TestCase("??????#?#?. 6,1", 1)]
    [TestCase("#??..??###??.??#???. 3,5,4", 9)]
    [TestCase("??##.?##.??????.? 3,2,1,1", 16)]
    [TestCase("??#????.??.????? 1,2,1,1,2", 40)]
    [TestCase("#?#????????.??????? 5,2,5", 12)]
    [TestCase("???????.????? 2,1,1,1", 86)]
    [TestCase("????.????###???? 2,6", 15)]
    [TestCase("#??##?##????.. 9,1", 2)]
    [TestCase("#??#.##??? 1,1,3", 1)]
    [TestCase("###?.?##?.? 3,4,1", 1)]
    [TestCase("??#???##?#?????# 2,11", 2)]
    [TestCase(".?#.??.??.? 1,2,1", 4)]
    [TestCase("??????#????.? 2,6", 6)]
    [TestCase("???##?#???.?#??#? 4,1,4", 3)]
    [TestCase("....???#?..##?..??? 5,2,2", 2)]
    [TestCase("?..?..?????.##?###?? 1,1,4,6,1", 2)]
    [TestCase("#??????????? 2,1,1,4", 4)]
    [TestCase("??#?????.?????#??.? 5,2,4", 12)]
    [TestCase(".?????.????? 1,1,3", 23)]
    [TestCase("?#?.?????#????#?#??? 3,2,1,5", 13)]
    [TestCase(".?#??????.? 3,1", 9)]
    [TestCase("#???.??.??.# 4,1,1,1", 4)]
    [TestCase("?.#?.????????.??? 1,2,2,1,2", 42)]
    [TestCase("??.?#?##??????.. 5,1", 9)]
    [TestCase("??####????.?#?.?? 7,2", 6)]
    [TestCase(".?###??????????## 5,2,1,2", 16)]
    [TestCase("#??.?????.???#? 2,2,1,2", 18)]
    [TestCase("????????#??.??#? 1,1,3,3", 62)]
    [TestCase(".?????????????# 3,7", 4)]
    [TestCase("###?#?.??? 3,2,1", 3)]
    [TestCase("?#?##??..#?#?? 5,1,1", 2)]
    [TestCase(".#?.?#...??# 2,2,3", 1)]
    [TestCase(".#???#?????#??. 1,1,6", 2)]
    [TestCase("??##????????? 5,4", 9)]
    [TestCase(".??##??.????.?? 5,1", 12)]
    [TestCase("???#?#.#??###?#?.# 1,1,1,1,5,1", 2)]
    [TestCase("?????#????? 3,1", 11)]
    [TestCase(".?????.?#.? 1,1,2", 6)]
    [TestCase("??????..?.?? 1,2,1,1", 15)]
    [TestCase("????#.???????????.? 1,7", 5)]
    [TestCase("??#??????##??#. 3,2,5", 6)]
    [TestCase("???????.???#??.???. 5,1,1,1,1,2", 4)]
    [TestCase("?#?????#?##.???#??.? 1,5,2,1,4,1", 1)]
    [TestCase(".???#..???????? 4,1,3", 10)]
    [TestCase("?????.???. 2,1,1", 13)]
    [TestCase("??#??.##??.? 2,2,1,1", 2)]
    [TestCase(".??#???????...??#??? 10,1,1,1", 2)]
    [TestCase(".##??#???????..????. 5,2,1", 27)]
    [TestCase(".?#?.?.???#? 2,3", 4)]
    [TestCase("???????.???#?? 1,2,5", 20)]
    [TestCase("???.??????.????#??? 3,3", 16)]
    [TestCase("??????????????#.? 1,1,1,5,1", 50)]
    [TestCase("???????.#?? 4,2", 4)]
    [TestCase("#?????#????????.? 1,1,8,1", 10)]
    [TestCase("###??#????? 6,1", 4)]
    [TestCase("???????????#?..???# 3,5,3", 9)]
    [TestCase("??#####??????.?? 6,3,1", 11)]
    [TestCase("?.????.??.?? 3,1", 8)]
    [TestCase(".##??#????#..??... 2,7,1", 2)]
    [TestCase("??#?#?????.#. 4,1,1", 7)]
    [TestCase("#?????##?#??..???? 2,1,6,1,2", 3)]
    [TestCase("??###????????? 7,1", 15)]
    [TestCase("???.??.#?#.?????? 3,2,3,2,2", 3)]
    [TestCase("?#?????#?????? 2,8", 7)]
    [TestCase("???????#?#? 1,2,3", 6)]
    [TestCase("?#?#??.?#.??##???? 4,1,1,1,5", 1)]
    [TestCase("??????#??# 1,5", 4)]
    [TestCase("?#?..??#??. 1,4", 2)]
    [TestCase("???????????. 4,1", 21)]
    [TestCase(".?##?#????????#??.. 4,8", 3)]
    [TestCase("???.????...????.. 2,2", 21)]
    [TestCase("??????.#..??? 1,2,1,1", 19)]
    [TestCase("?????????? 1,3", 21)]
    [TestCase("???#?.??????.? 4,1,1,1", 28)]
    [TestCase("?.???????#. 1,1,2", 11)]
    [TestCase("??.??????.????#?? 2,1,1,2,5", 3)]
    [TestCase(".???#??????.#??. 9,2", 2)]
    [TestCase("?#?#?.??.????. 2,2,2", 4)]
    [TestCase(".?.?????.? 1,2", 7)]
    [TestCase("#????#?#???.???.? 1,3,1,3", 3)]
    [TestCase("..#?##???????#??.??# 6,1,3,1,1,1", 1)]
    [TestCase("?.?..#?????.???????. 2,5", 3)]
    [TestCase("?.?.???.???? 1,2", 20)]
    [TestCase("?.#???.?..?.#?? 1,3,1,1,2", 1)]
    [TestCase("?.??#???.????? 1,4,1,2", 16)]
    [TestCase("#??.??.??# 3,2,1", 1)]
    [TestCase("????#???????#? 5,3", 10)]
    [TestCase("?#?.?#??.?????? 2,3,4", 12)]
    [TestCase("##???.??????? 5,1,1,1", 10)]
    [TestCase("??..?##?????????. 5,1", 11)]
    [TestCase(".??????.#??#.##...# 4,1,4,2,1", 1)]
    [TestCase("?.???#???.???. 1,4,2", 15)]
    [TestCase("##?#???????.?????##? 6,3,1,4", 10)]
    [TestCase("???.??.#?#? 2,1,3", 4)]
    [TestCase("???.?.##..?????? 2,1,2,4", 6)]
    [TestCase("#????#??##??.?#? 2,1,4,2", 4)]
    [TestCase("#????#?????.???.. 1,1,2,2,2", 14)]
    [TestCase("???#?.??.????? 1,3,5", 1)]
    [TestCase("?????##??????????# 1,6,1,1,1", 65)]
    [TestCase("?#?#???.#???????.. 4,8", 2)]
    [TestCase("???#??#???..?#?. 2,5,3", 2)]
    [TestCase("?.???#.?.??????? 2,2", 6)]
    [TestCase(".?#?#???#???#?#?? 4,9", 5)]
    [TestCase(".?#?..#?##????.???.. 2,4,1,1,1,1", 2)]
    [TestCase("???#..?.?? 4,1", 3)]
    [TestCase(".#??.?#???#??.???? 1,8,2", 3)]
    [TestCase(".?????#??##?#???? 2,2,2,1,1", 15)]
    [TestCase("???.?#?.?. 2,2", 4)]
    [TestCase("?##??#??.??.##??#??. 6,7", 2)]
    [TestCase(".#.??????#?????#?# 1,1,3,3,5", 1)]
    [TestCase(".?.?????????????##? 1,3,1,7", 21)]
    [TestCase("??.??????#?##??? 1,1,3,3,1", 7)]
    [TestCase("?????.##?#? 1,1,5", 6)]
    [TestCase(".##.??#?.??.?? 2,2,1,1", 8)]
    [TestCase("??#..#??#?..#??? 3,5,1,1", 2)]
    [TestCase("??#????????#?????? 13,2", 6)]
    [TestCase("?#????..?.??? 2,1,1", 29)]
    [TestCase("?????#?.#????. 4,2", 2)]
    [TestCase(".?##?.?..? 4,1", 2)]
    [TestCase("?##?#??#?##??#?? 12,2", 1)]
    [TestCase("#?##?.???????#?#?#? 1,2,1,8,2", 1)]
    [TestCase("?.?.##?.????#??# 1,2,1,1,4", 2)]
    [TestCase("????.???#?.? 1,1,2", 18)]
    [TestCase("..????##???????#???? 7,5", 19)]
    [TestCase("??????#??????? 1,8,2", 4)]
    [TestCase("?#?????????. 1,1,5", 3)]
    [TestCase("??#?##???????????.? 8,1,3", 19)]
    [TestCase("#.??##???###??. 1,10,1", 1)]
    [TestCase(".????#??#?#???.???# 12,4", 2)]
    [TestCase("??.?#????#?.???.. 1,7,1,1", 4)]
    [TestCase("???#####?????.##?? 7,1,3", 9)]
    [TestCase("?.?????.#?#?.?. 1,5,3,1", 1)]
    [TestCase("..??..##?????. 2,2,2", 3)]
    [TestCase("??????????#? 1,1,1,1", 35)]
    [TestCase("#?#??.??##??#..? 4,2,1", 1)]
    [TestCase("#?.????.???.? 1,4,3,1", 1)]
    [TestCase("?????#????##?#?### 1,1,1,1,8", 6)]
    [TestCase("?.??##??.?#.? 6,1", 1)]
    [TestCase("#???????.????? 4,1,3,1", 3)]
    [TestCase("#???#???#??..?#..??? 3,1,1,3,2,1", 3)]
    [TestCase("#??.???????#????? 3,9", 5)]
    [TestCase("??#?##????#??????.? 5,8", 5)]
    [TestCase("#???????#???.?#???#? 1,1,5,2,3", 30)]
    [TestCase(".#???#????###.??. 1,8,1", 2)]
    [TestCase("?#???#?##?##???##?#? 2,12,1", 2)]
    [TestCase("#.?.#???#.? 1,1,2", 1)]
    [TestCase("?.??#?#.???#?????.?? 3,3", 3)]
    [TestCase("???#.??.??#??#??? 1,5", 2)]
    [TestCase("?????#???? 2,3,1", 10)]
    [TestCase("????.?#??#?????????. 2,1,5,2,4", 4)]
    [TestCase(".?????.#???##?#.?.? 2,1,6,1,1,1", 3)]
    [TestCase("?..#?.??...?#? 1,1,1", 3)]
    [TestCase("?#.??????? 1,1,1", 15)]
    [TestCase("??###..?#? 4,2", 2)]
    [TestCase("????##.?#.#???????? 1,2,1,5,2", 6)]
    [TestCase("#??.?###?##???.?? 1,1,6,1,1", 4)]
    [TestCase("???#?????...???.??? 4,2", 22)]
    [TestCase("?.?.??.??#????.? 1,1,5,1", 24)]
    [TestCase("??#?.?????.?????? 2,1,1,1,4", 18)]
    [TestCase("?.?.???.?#?#???? 1,1,2,3,1", 14)]
    [TestCase("??##?..??#??.?.. 2,1,1", 3)]
    [TestCase(".??.??.???? 1,2,2", 6)]
    [TestCase("?#.??##????#.???? 1,3,3,2", 6)]
    [TestCase("??#?#??????#?# 5,7", 2)]
    [TestCase("??#.??#.#?#???. 2,1,1,6", 1)]
    [TestCase("??#????.??. 5,1", 7)]
    [TestCase("????#??.???##?#?#? 6,8", 4)]
    [TestCase("#???#??#?? 2,1,1", 1)]
    [TestCase("??.???#???#? 1,5", 4)]
    [TestCase(".#...??.????.?# 1,2,1,1,1", 3)]
    [TestCase("##.????#?.#..?#? 2,4,1,2", 4)]
    [TestCase("????#???#?.?.?#??? 9,1", 2)]
    [TestCase("?#.???#??#??????#? 1,4,1,1,1,1", 6)]
    [TestCase("??????.??.?????#..? 2,4", 6)]
    [TestCase("??.?###?.???#??##??? 4,5", 2)]
    [TestCase("?#..##???#?#?? 2,10", 1)]
    [TestCase("..??????#?.?##?. 1,4,3", 10)]
    [TestCase("?????????? 2,5", 6)]
    [TestCase("????.?????????#?##?. 1,1,2,2,2,5", 3)]
    [TestCase(".?????#?.#?????? 1,3,4,2", 5)]
    [TestCase("??.????#?. 1,4", 5)]
    [TestCase("?#?#..#.#??##????? 3,1,6,1", 3)]
    [TestCase("?..?.??.??????? 1,2,6", 4)]
    [TestCase(".#??#?#?????## 2,3,6", 1)]
    [TestCase("?#?..???...???##.? 1,3,5,1", 1)]
    [TestCase("?###??????##?#?..??? 3,3,6,2", 2)]
    [TestCase("?????#.?#???. 1,2,1,4", 2)]
    [TestCase("???????.??#???? 1,1,1,5", 45)]
    [TestCase(".???.??..?#???.?? 2,3", 6)]
    [TestCase("#.??.#?????..???# 1,1,3,1,4", 4)]
    [TestCase("?.??.?????????. 1,1,2,6", 2)]
    [TestCase("?#.#???..?.?#?? 2,1,1,1,2", 4)]
    [TestCase("????????#??.??#????? 1,1,4,1,6", 28)]
    [TestCase(".#????#?#.? 3,1,1", 1)]
    [TestCase("?#??#.????.#?.. 1,1,2,1,1", 1)]
    [TestCase("?????##??.?????? 2,6,1,2", 6)]
    [TestCase("#.??.???.???????. 1,2,1,1,4", 13)]
    [TestCase("??##?#?#??..??? 7,3", 2)]
    [TestCase("?#???.??.?. 4,2,1", 2)]
    [TestCase("?????#?????.# 5,1,1", 10)]
    [TestCase("?#?.??#?.?#? 1,3,3", 2)]
    [TestCase("?.??.???#?#???. 1,5", 12)]
    [TestCase("??##.?#???.???.#. 3,4,2,1", 4)]
    [TestCase(".???..??.??. 3,1,1", 4)]
    [TestCase("#?..?.??#?.? 2,3,1", 2)]
    [TestCase("##???#.?#?.#?? 6,1,2", 1)]
    [TestCase("?#.??.?#.? 2,1,1", 3)]
    [TestCase("???????????? 1,1,1,1", 126)]
    [TestCase("?..#???#??#?#?.?# 1,2,3,4,1", 1)]
    [TestCase("?##?#??????????##. 11,3", 2)]
    [TestCase("#?#??..?.#?????#???# 1,1,1,1,11", 1)]
    [TestCase("??.?##?#??.??#???? 1,6,5,1", 4)]
    [TestCase("??.?#?#..?.?. 4,1", 2)]
    [TestCase("##?..????.?#.?#? 3,1,2,2,2", 2)]
    [TestCase("???#.???#? 1,1,2", 7)]
    [TestCase("??#?????#?#?#???#? 13,1", 3)]
    [TestCase("??#?...??.#?.?#?? 1,2,1,2", 4)]
    [TestCase("?.??.????#.????.??. 1,1,1,1,4,1", 18)]
    [TestCase("??.?????.#? 1,5,1", 2)]
    [TestCase("??.#?????#.. 1,4,1", 2)]
    [TestCase("?..#??????.?? 2,1", 6)]
    [TestCase("??#???#?.#?? 6,2", 2)]
    [TestCase("???????#?.#?? 3,1,2,3", 4)]
    [TestCase("?#?#??##.?#???#??? 8,1,5", 2)]
    [TestCase("??##?????.????? 5,1,1,1", 44)]
    [TestCase("???..??.?##. 1,1,1,3", 2)]
    [TestCase("?.?#?..#.?#? 3,1,3", 1)]
    [TestCase(".???????#??#? 7,1", 2)]
    [TestCase(".#.????#?#?#?. 1,3,3,2", 1)]
    [TestCase("??#.#..????????#??#. 3,1,8,1", 2)]
    [TestCase("#??????#.??? 1,1,1,1", 16)]
    [TestCase("?#?????#???? 2,1,1,1", 18)]
    [TestCase("#?????#??#??#.?#??? 1,7,1,1,1", 4)]
    [TestCase("???#.???.???.?? 3,2,1,2", 6)]
    [TestCase("??#?.???#####?##?? 1,1,1,10", 3)]
    [TestCase("??#?????.#??? 6,1,2", 4)]
    [TestCase("????#????#?.?? 2,4,2", 7)]
    [TestCase("????????#? 1,1,5", 4)]
    [TestCase("???#???.?#.?? 4,2,1", 9)]
    [TestCase("?#??..???#?#??????#? 4,1,5,4", 6)]
    [TestCase("?#?.?#?#???##?#? 1,4,4,1", 1)]
    [TestCase("???#.?.#?????# 3,1,1,1", 4)]
    [TestCase("???.?#?.????? 2,1,5", 2)]
    [TestCase(".?????#?#??##.?????? 9,3", 4)]
    [TestCase("??#???#.???? 7,1", 4)]
    [TestCase("????#?####.?#? 6,2", 2)]
    [TestCase("?.?????????#??.# 1,1,2,6,1", 4)]
    [TestCase("?????.?.???#???? 4,1,4,2", 6)]
    [TestCase("#?.?.??#?#??? 1,1,3,1", 5)]
    [TestCase("??#?.?????#??? 4,1,5", 6)]
    [TestCase("?.?????.##..??? 1,2,1", 18)]
    [TestCase("???###?#??.???.? 7,1", 13)]
    public void RealData(string input, int expected)
    {
        var result = Aoc202312.CombinationCount(input);

        result.Should().Be(expected);
    }

    [TestCase("#.#??????? 1,1,4", 3)]
    [TestCase("##..??#??##?? 2,8", 2)]
    [TestCase("#???.?????? 2,2", 5)]
    [TestCase("##??##??#?.?.??. 10,1", 3)]
    public void SelectedRealData(string input, int expected)
    {
        var result = Aoc202312.CombinationCount(input);

        result.Should().Be(expected);
    }

    [TestCase("???.### 1,1,3", 1)]
    [TestCase(".??..??...?##. 1,1,3", 16384)]
    [TestCase("?#?#?#?#?#?#?#? 1,3,1,6", 1)]
    [TestCase("????.#...#... 4,1,1", 16)]
    [TestCase("????.######..#####. 1,6,5", 2500)]
    [TestCase("?###???????? 3,2,1", 506250)]
    public void CombinationCountPart2(string input, int expected)
    {
        var result = Aoc202312.CombinationCount(input, true);

        result.Should().Be(expected);
    }
}